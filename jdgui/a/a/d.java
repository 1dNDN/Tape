/*     */ package a.a;
/*     */ 
/*     */ import a.a.a.g;
/*     */ import a.a.a.h;
/*     */ import java.io.IOException;
/*     */ import java.net.DatagramPacket;
/*     */ import java.net.SocketAddress;
/*     */ import java.util.Iterator;
/*     */ import java.util.Map;
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ class d
/*     */   extends Thread
/*     */ {
/*     */   public d(b paramb) {
/* 454 */     super("ReliableServerSocket");
/* 455 */     setDaemon(true);
/*     */   }
/*     */ 
/*     */   
/*     */   public void run() {
/* 460 */     byte[] arrayOfByte = new byte[65535];
/*     */ 
/*     */ 
/*     */ 
/*     */     
/*     */     while (true) {
/* 466 */       DatagramPacket datagramPacket = new DatagramPacket(arrayOfByte, arrayOfByte.length);
/* 467 */       e e = null;
/*     */       
/* 469 */       SocketAddress socketAddress = null;
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */       
/*     */       try {
/*     */         try {
/* 477 */           b.a(this.a).receive(datagramPacket);
/*     */         }
/* 479 */         catch (IOException iOException) {
/*     */           
/* 481 */           b.a(this.a, "IOException receiving packet:" + iOException.getMessage() + " isConnected:" + b.a(this.a).isConnected());
/*     */           
/* 483 */           if (!b.a(this.a).isConnected())
/*     */           {
/* 485 */             this.a.close();
/*     */           }
/*     */           
/* 488 */           throw new IOException(iOException);
/*     */         } 
/*     */ 
/*     */         
/* 492 */         socketAddress = datagramPacket.getSocketAddress();
/*     */         
/* 494 */         synchronized (b.b(this.a)) {
/*     */ 
/*     */           
/* 497 */           a a = (a)b.c(this.a).get(socketAddress);
/*     */           
/* 499 */           if (a != null) {
/* 500 */             a.a(datagramPacket.getData(), datagramPacket.getLength());
/*     */             
/*     */             continue;
/*     */           } 
/*     */         } 
/* 505 */         synchronized (b.b(this.a)) {
/*     */           
/* 507 */           e = (e)b.b(this.a).get(socketAddress);
/*     */         } 
/*     */ 
/*     */         
/* 511 */         if (e == null) {
/*     */           
/* 513 */           c c = this.a.a;
/* 514 */           if (c != null)
/*     */           {
/* 516 */             if (!c.a(socketAddress)) {
/*     */               continue;
/*     */             }
/*     */           }
/*     */         } 
/*     */ 
/*     */         
/* 523 */         h h = h.b(datagramPacket.getData(), 0, datagramPacket.getLength());
/*     */         
/* 525 */         if (!this.a.isClosed())
/*     */         {
/* 527 */           if (e == null) {
/*     */             
/* 529 */             if (h instanceof g) {
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */               
/* 535 */               long l = System.currentTimeMillis();
/*     */               
/* 537 */               if (b.d(this.a).size() > 0) {
/*     */                 
/* 539 */                 char c = '✐';
/*     */ 
/*     */                 
/* 542 */                 if (b.d(this.a).size() > 20)
/*     */                 {
/* 544 */                   c = 'ᎈ';
/*     */                 }
/* 546 */                 if (b.d(this.a).size() > 200)
/*     */                 {
/* 548 */                   c = 'ஸ';
/*     */                 }
/*     */                 
/* 551 */                 Iterator<Map.Entry> iterator = b.d(this.a).entrySet().iterator();
/*     */ 
/*     */                 
/* 554 */                 while (iterator.hasNext()) {
/*     */                   
/* 556 */                   Map.Entry entry = iterator.next();
/*     */                   
/* 558 */                   if (((g)entry.getValue()).a + c < l) {
/* 559 */                     iterator.remove();
/*     */                   }
/*     */                 } 
/*     */               } 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */               
/* 569 */               g g = (g)b.d(this.a).get(socketAddress);
/*     */               
/* 571 */               if (g != null) {
/*     */ 
/*     */                 
/* 574 */                 g.b.a((g)h);
/*     */               
/*     */               }
/*     */               else {
/*     */                 
/* 579 */                 g = new g();
/* 580 */                 g.a = l;
/*     */                 
/* 582 */                 g.b = new e(this.a, b.a(this.a), socketAddress);
/*     */                 
/* 584 */                 g.b.a((g)h);
/*     */                 
/* 586 */                 b.d(this.a).put(socketAddress, g);
/*     */               } 
/*     */             } 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */             
/* 597 */             if (h instanceof a.a.a.a) {
/*     */ 
/*     */ 
/*     */ 
/*     */               
/* 602 */               g g = (g)b.d(this.a).get(socketAddress);
/*     */               
/* 604 */               if (g != null) {
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */                 
/* 611 */                 e e1 = g.b;
/*     */                 
/* 613 */                 if (!e1.b(h)) {
/*     */                   
/* 615 */                   b.a(this.a, "lightweight ack failed ack:" + h.n());
/*     */                   
/*     */                   continue;
/*     */                 } 
/* 619 */                 b.a(this.a, socketAddress, e1);
/* 620 */                 e = e1;
/*     */                 
/* 622 */                 b.d(this.a).remove(socketAddress);
/*     */               } 
/*     */             } 
/*     */           } 
/*     */         }
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */ 
/*     */         
/* 635 */         if (e != null) {
/* 636 */           e.a(h);
/*     */         }
/*     */       }
/* 639 */       catch (IOException iOException) {
/* 640 */         if (this.a.isClosed()) {
/*     */           break;
/*     */         }
/*     */         
/* 644 */         b.a(this.a, "IOException client " + socketAddress + " - " + iOException.getMessage());
/*     */ 
/*     */       
/*     */       }
/* 648 */       catch (IllegalArgumentException illegalArgumentException) {
/* 649 */         if (this.a.isClosed()) {
/*     */           break;
/*     */         }
/* 652 */         b.a(this.a, "IllegalArgumentException " + socketAddress + " - " + illegalArgumentException.getMessage());
/*     */       } 
/*     */     } 
/*     */   }
/*     */ }


/* Location:              D:\Rusted Warfare\Rusted Warfare\game-lib.jar!\a\a\d.class
 * Java compiler version: 8 (52.0)
 * JD-Core Version:       1.1.3
 */